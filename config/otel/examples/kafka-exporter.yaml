# OTEL Collector - Kafka Exporter Configuration
# Export logs, traces, and metrics to Apache Kafka
#
# Usage:
# 1. Add this exporter to otel-collector-config.yaml
# 2. Add 'kafka' to pipeline exporters
# 3. Ensure Kafka cluster is running

exporters:
  # Kafka exporter for logs
  kafka/logs:
    brokers:
      - kafka:9092
    topic: telemetryflow.logs
    encoding: otlp_json
    
    # Authentication (optional)
    # auth:
    #   sasl:
    #     username: user
    #     password: pass
    #     mechanism: PLAIN
    
    # Producer settings
    producer:
      max_message_bytes: 1000000
      required_acks: 1
      compression: gzip
    
    # Metadata
    metadata:
      full: true
      retry:
        max: 3
        backoff: 250ms
  
  # Kafka exporter for traces
  kafka/traces:
    brokers:
      - kafka:9092
    topic: telemetryflow.traces
    encoding: otlp_json
    producer:
      max_message_bytes: 1000000
      required_acks: 1
      compression: gzip
  
  # Kafka exporter for metrics
  kafka/metrics:
    brokers:
      - kafka:9092
    topic: telemetryflow.metrics
    encoding: otlp_json
    producer:
      max_message_bytes: 1000000
      required_acks: 1
      compression: gzip

# Add to service.pipelines:
# logs:
#   receivers: [otlp]
#   processors: [memory_limiter, batch]
#   exporters: [debug, kafka/logs]
#
# traces:
#   receivers: [otlp]
#   processors: [memory_limiter, batch]
#   exporters: [otlp/jaeger, debug, kafka/traces]
#
# metrics:
#   receivers: [otlp, prometheus]
#   processors: [memory_limiter, batch]
#   exporters: [prometheus, debug, kafka/metrics]

# Docker Compose service example:
# kafka:
#   image: confluentinc/cp-kafka:latest
#   environment:
#     KAFKA_BROKER_ID: 1
#     KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
#     KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092
#   ports:
#     - "9092:9092"
#   networks:
#     - telemetryflow_core_net
